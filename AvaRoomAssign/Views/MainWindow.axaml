<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:AvaRoomAssign.ViewModels"
        xmlns:models="using:AvaRoomAssign.Models"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="950"
        x:Class="AvaRoomAssign.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/house.ico"
        Title="抢房好好好 - Avalonia版 Ver 2.0.0 By: hp"
        Width="1000" Height="950"
        MinWidth="1000" MinHeight="700"
        WindowStartupLocation="CenterScreen"
        CanResize="true">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Window.Resources>
        <models:BoolToInverseBoolConverter x:Key="BoolToInverseConverter"/>
        <models:IntToBoolConverter x:Key="IntToBoolConverter"/>
        <models:MultiBoolConverter x:Key="MultiBoolConverter"/>
        
        <!-- 浅色主题资源 - 现代清新配色 -->
        <SolidColorBrush x:Key="ThemeBackground" Color="#F7F9FC"/>
        <SolidColorBrush x:Key="ThemeCardBackground" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="ThemeTextPrimary" Color="#1A202C"/>
        <SolidColorBrush x:Key="ThemeTextSecondary" Color="#718096"/>
        <SolidColorBrush x:Key="ThemeBorder" Color="#E2E8F0"/>
        <SolidColorBrush x:Key="ThemeAccent" Color="#4299E1"/>
        <SolidColorBrush x:Key="ThemeAccentHover" Color="#3182CE"/>
        <SolidColorBrush x:Key="ThemeSuccess" Color="#48BB78"/>
        <SolidColorBrush x:Key="ThemeWarning" Color="#ED8936"/>
        <SolidColorBrush x:Key="ThemeDanger" Color="#F56565"/>
        <SolidColorBrush x:Key="ThemeLogBackground" Color="#F7FAFC"/>
        <SolidColorBrush x:Key="ThemeLogText" Color="#38A169"/>
        <!-- 表格相关颜色 -->
        <SolidColorBrush x:Key="ThemeTableAlternating" Color="#F7FAFC"/>
        <SolidColorBrush x:Key="ThemeTableHover" Color="#EBF8FF"/>
        <SolidColorBrush x:Key="ThemeTableSelected" Color="#BEE3F8"/>
        
        <!-- 深色主题资源 - 深邃现代配色 -->
        <SolidColorBrush x:Key="DarkThemeBackground" Color="#0F1419"/>
        <SolidColorBrush x:Key="DarkThemeCardBackground" Color="#1A202C"/>
        <SolidColorBrush x:Key="DarkThemeTextPrimary" Color="#F7FAFC"/>
        <SolidColorBrush x:Key="DarkThemeTextSecondary" Color="#A0AEC0"/>
        <SolidColorBrush x:Key="DarkThemeBorder" Color="#2D3748"/>
        <SolidColorBrush x:Key="DarkThemeAccent" Color="#63B3ED"/>
        <SolidColorBrush x:Key="DarkThemeAccentHover" Color="#90CDF4"/>
        <SolidColorBrush x:Key="DarkThemeSuccess" Color="#68D391"/>
        <SolidColorBrush x:Key="DarkThemeWarning" Color="#F6AD55"/>
        <SolidColorBrush x:Key="DarkThemeDanger" Color="#FC8181"/>
        <SolidColorBrush x:Key="DarkThemeLogBackground" Color="#171923"/>
        <SolidColorBrush x:Key="DarkThemeLogText" Color="#9AE6B4"/>
        <!-- 深色主题表格相关颜色 -->
        <SolidColorBrush x:Key="DarkThemeTableAlternating" Color="#2D3748"/>
        <SolidColorBrush x:Key="DarkThemeTableHover" Color="#4A5568"/>
        <SolidColorBrush x:Key="DarkThemeTableSelected" Color="#3182CE"/>
    </Window.Resources>

    <Window.Styles>
        <!-- 卡片样式 -->
        <Style Selector="Border.modern-card">
            <Setter Property="Background" Value="{DynamicResource ThemeCardBackground}"/>
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="Padding" Value="24"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#10000000" OffsetX="0" OffsetY="4" BlurRadius="20"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 可折叠卡片样式 -->
        <Style Selector="Border.collapsible-card">
            <Setter Property="Background" Value="{DynamicResource ThemeCardBackground}"/>
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#08000000" OffsetX="0" OffsetY="2" BlurRadius="12"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 折叠面板头部样式 -->
        <Style Selector="Button.collapse-header">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="CornerRadius" Value="16,16,0,0"/>
            <Setter Property="Padding" Value="24,20"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
        </Style>

        <Style Selector="Button.collapse-header:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeTableHover}"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <Style Selector="Button.collapse-header:pressed /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeTableSelected}"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <!-- 主要按钮样式 - 使用主题色 -->
        <Style Selector="Button.modern-primary">
            <Setter Property="Background" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20,14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#40000000" OffsetX="0" OffsetY="2" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style Selector="Button.modern-primary:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeAccentHover}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,14"/>
        </Style>

        <Style Selector="Button.modern-primary:pressed /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeAccentHover}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,14"/>
            <Setter Property="Opacity" Value="0.8"/>
        </Style>

        <Style Selector="Button.modern-primary:disabled /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextSecondary}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,14"/>
        </Style>

        <!-- 次要按钮样式 -->
        <Style Selector="Button.modern-secondary">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20,14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccent}"/>
        </Style>

        <Style Selector="Button.modern-secondary:pointerover">
            <Setter Property="Background" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="Padding" Value="20,14"/>
        </Style>

        <!-- 危险按钮样式 -->
        <Style Selector="Button.modern-danger">
            <Setter Property="Background" Value="{DynamicResource ThemeDanger}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <Style Selector="Button.modern-danger:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeDanger}"/>
            <Setter Property="Opacity" Value="0.8"/>
        </Style>

        <!-- 主题切换按钮 -->
        <Style Selector="Button.theme-toggle">
            <Setter Property="Background" Value="{DynamicResource ThemeWarning}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="CornerRadius" Value="24"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="48"/>
            <Setter Property="Height" Value="48"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#40000000" OffsetX="0" OffsetY="2" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style Selector="Button.theme-toggle:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeWarning}"/>
            <Setter Property="Opacity" Value="0.8"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>

        <!-- GitHub图标按钮样式 -->
        <Style Selector="Button.github-icon">
            <Setter Property="Background" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeCardBackground}"/>
            <Setter Property="CornerRadius" Value="24"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="48"/>
            <Setter Property="Height" Value="48"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#40000000" OffsetX="0" OffsetY="2" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style Selector="Button.github-icon:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeTextSecondary}"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>

        <!-- 标签样式 -->
        <Style Selector="TextBlock.modern-label">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>

        <!-- 标题样式 -->
        <Style Selector="TextBlock.modern-title">
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="28"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
        </Style>

        <!-- 副标题样式 -->
        <Style Selector="TextBlock.modern-subtitle">
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextSecondary}"/>
        </Style>

        <!-- 日志文本框样式 -->
        <Style Selector="TextBox.modern-log">
            <Setter Property="Background" Value="{DynamicResource ThemeLogBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeLogText}"/>
            <Setter Property="FontFamily" Value="Consolas, 'SF Mono', 'Monaco', 'Menlo', monospace"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeSuccess}"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="MinHeight" Value="60"/>
            <Setter Property="VerticalAlignment" Value="Stretch"/>
            <Setter Property="VerticalContentAlignment" Value="Top"/>
        </Style>

        <!-- DataGrid样式 - 现代化设计 -->
        <Style Selector="DataGrid.modern">
            <Setter Property="Background" Value="{DynamicResource ThemeCardBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="RowBackground" Value="Transparent"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="GridLinesVisibility" Value="None"/>
            <Setter Property="CanUserReorderColumns" Value="False"/>
            <Setter Property="CanUserSortColumns" Value="False"/>
            <Setter Property="CanUserResizeColumns" Value="False"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="RowHeight" Value="48"/>
        </Style>

        <!-- DataGrid Header样式 -->
        <Style Selector="DataGrid.modern DataGridColumnHeader">
            <Setter Property="Background" Value="{DynamicResource ThemeTableAlternating}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Height" Value="44"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Border Background="{DynamicResource ThemeTableAlternating}"
                                BorderBrush="{DynamicResource ThemeBorder}"
                                BorderThickness="0,0,1,1"
                                CornerRadius="{TemplateBinding CornerRadius}">
                            <ContentPresenter Content="{TemplateBinding Content}"
                                              ContentTemplate="{TemplateBinding ContentTemplate}"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              Margin="12,14"
                                              TextBlock.Foreground="{DynamicResource ThemeTextPrimary}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 第一个表头的圆角 -->
        <Style Selector="DataGrid.modern DataGridColumnHeader:nth-child(1)">
            <Setter Property="CornerRadius" Value="12,0,0,0"/>
        </Style>

        <!-- 最后一个表头的圆角 -->
        <Style Selector="DataGrid.modern DataGridColumnHeader:last-child">
            <Setter Property="CornerRadius" Value="0,12,0,0"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
        </Style>

        <!-- DataGrid Row样式 -->
        <Style Selector="DataGrid.modern DataGridRow">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="MinHeight" Value="48"/>
        </Style>

        <!-- DataGrid 交替行背景 -->
        <Style Selector="DataGrid.modern DataGridRow:nth-child(even)">
            <Setter Property="Background" Value="{DynamicResource ThemeTableAlternating}"/>
        </Style>

        <!-- DataGrid 悬停效果 -->
        <Style Selector="DataGrid.modern DataGridRow:pointerover">
            <Setter Property="Background" Value="{DynamicResource ThemeTableHover}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
        </Style>

        <!-- DataGrid 选中效果 -->
        <Style Selector="DataGrid.modern DataGridRow:selected">
            <Setter Property="Background" Value="{DynamicResource ThemeTableSelected}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
        </Style>

        <!-- DataGrid 选中且悬停 -->
        <Style Selector="DataGrid.modern DataGridRow:selected:pointerover">
            <Setter Property="Background" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
        </Style>

        <!-- DataGrid Cell样式 -->
        <Style Selector="DataGrid.modern DataGridCell">
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>
        
        <!-- DataGrid Cell内的TextBlock样式 -->
        <Style Selector="DataGrid.modern DataGridCell TextBlock">
            <Setter Property="TextAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
            <Setter Property="ToolTip.Tip" Value="{Binding Text, RelativeSource={RelativeSource Self}}"/>
        </Style>

        <!-- 信息图标样式 - 使用主题色 -->
        <Style Selector="Border.info-icon">
            <Setter Property="Background" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="CornerRadius" Value="18"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#40000000" OffsetX="0" OffsetY="2" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style Selector="Border.warning-icon">
            <Setter Property="Background" Value="{DynamicResource ThemeWarning}"/>
            <Setter Property="CornerRadius" Value="18"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#40000000" OffsetX="0" OffsetY="2" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style Selector="Border.success-icon">
            <Setter Property="Background" Value="{DynamicResource ThemeSuccess}"/>
            <Setter Property="CornerRadius" Value="18"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#40000000" OffsetX="0" OffsetY="2" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style Selector="Border.danger-icon">
            <Setter Property="Background" Value="{DynamicResource ThemeDanger}"/>
            <Setter Property="CornerRadius" Value="18"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#40000000" OffsetX="0" OffsetY="2" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 输入框样式 -->
        <Style Selector="TextBox">
            <Setter Property="Background" Value="{DynamicResource ThemeCardBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <Style Selector="TextBox:focus /template/ Border#PART_BorderElement">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="BorderThickness" Value="2"/>
        </Style>

        <!-- 下拉框样式 -->
        <Style Selector="ComboBox">
            <Setter Property="Background" Value="{DynamicResource ThemeCardBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <Style Selector="ComboBox:focus /template/ Border#Background">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccent}"/>
        </Style>

        <!-- DataGrid中的ComboBox样式 -->
        <Style Selector="DataGrid.modern ComboBox">
            <Setter Property="Background" Value="{DynamicResource ThemeCardBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="MinHeight" Value="32"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style Selector="DataGrid.modern ComboBox:focus /template/ Border#Background">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <Style Selector="DataGrid.modern ComboBox:pointerover /template/ Border#Background">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="{DynamicResource ThemeTableHover}"/>
        </Style>

        <!-- 复选框样式 -->
        <Style Selector="CheckBox">
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <Style Selector="CheckBox /template/ Border#NormalRectangle">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="Background" Value="{DynamicResource ThemeCardBackground}"/>
        </Style>

        <Style Selector="CheckBox:checked /template/ Border#NormalRectangle">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="Background" Value="{DynamicResource ThemeAccent}"/>
        </Style>
    </Window.Styles>

    <Grid Background="{DynamicResource ThemeBackground}" x:Name="MainGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 顶部标题栏和主题切换 - 增加渐变背景 -->
        <Border Grid.Row="0" 
                BorderBrush="{DynamicResource ThemeBorder}" 
                BorderThickness="0,0,0,1"
                Padding="24,24"
                x:Name="HeaderBorder">
            <Border.Background>
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                    <GradientStop Color="#FFFFFF" Offset="0"/>
                    <GradientStop Color="#F8F9FA" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Spacing="8">
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <TextBlock Classes="modern-title" Text="🏠" FontSize="32"/>
                        <TextBlock Classes="modern-title" Text="抢房好好好"/>
                    </StackPanel>
                    <TextBlock Classes="modern-subtitle" Text="Avalonia版 Ver 2.0.0 By: hp - 自动化抢公租房"/>
                </StackPanel>

                <Button Grid.Column="1" 
                        Classes="theme-toggle"
                        Content="🌙"
                        ToolTip.Tip="切换主题"
                        Click="OnThemeToggleClick"
                        x:Name="ThemeToggleButton"/>
            </Grid>
        </Border>

        <!-- 可滚动的配置区域 -->
        <ScrollViewer Grid.Row="1" 
                      VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled"
                      Padding="16,16,16,0"
                      x:Name="ConfigScrollViewer">
            <!-- 响应式容器 -->
            <Panel x:Name="ResponsiveContainer">
                <!-- 单列布局 (默认, 窗口宽度 < 1200px) -->
                <StackPanel x:Name="SingleColumnLayout" 
                           HorizontalAlignment="Stretch" 
                           Margin="0,0,0,0">
                    
                    <!-- 运行模式配置 -->
                    <Border Classes="collapsible-card" HorizontalAlignment="Stretch">
                        <Grid RowDefinitions="Auto,Auto">
                            <Button Grid.Row="0" 
                                    Classes="collapse-header"
                                    Click="OnOperationModeToggle"
                                    x:Name="OperationModeToggleSingle">
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <TextBlock Text="🚀" FontSize="20" VerticalAlignment="Center"/>
                                    <TextBlock Text="运行模式配置" VerticalAlignment="Center"/>
                                    <TextBlock Text="▼" 
                                               x:Name="OperationModeIconSingle"
                                               FontSize="14" 
                                               VerticalAlignment="Center" 
                                               Foreground="{DynamicResource ThemeTextSecondary}"/>
                                </StackPanel>
                            </Button>

                            <StackPanel Grid.Row="1" 
                                        x:Name="OperationModeContentSingle"
                                        Spacing="20" 
                                        Margin="24,0,24,24">
                                <Grid ColumnDefinitions="*,*,Auto" HorizontalAlignment="Stretch">
                                    <StackPanel Grid.Column="0" Spacing="8" HorizontalAlignment="Stretch">
                                        <TextBlock Classes="modern-label" Text="运行模式"/>
                                        <ComboBox SelectedIndex="{Binding SelectedOperationMode}"
                                                  ItemsSource="{Binding OperationModes}"
                                                  IsEnabled="{Binding !IsRunning}"
                                                  HorizontalAlignment="Stretch"
                                                  ToolTip.Tip="模拟点击模式可以看到具体的操作，在最后一步确认需要手动点击，成功率较高，但是速度较发包模式慢；发包模式理论速度最快，但是需要cookie，并且不保证成功率"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="1" Spacing="8" Margin="24,0,0,0" HorizontalAlignment="Stretch">
                                        <TextBlock Classes="modern-label" Text="浏览器类型"/>
                                        <ComboBox SelectedIndex="{Binding SelectedBrowserType}"
                                                  ItemsSource="{Binding BrowserTypes}"
                                                  IsEnabled="{Binding !IsRunning}"
                                                  HorizontalAlignment="Stretch"/>
                                    </StackPanel>

                                    <Border Grid.Column="2" Classes="info-icon"
                                            Width="40" Height="40" 
                                            VerticalAlignment="Bottom"
                                            Margin="24,0,0,0"
                                            ToolTip.Tip="模拟点击模式可以看到具体的操作，在最后一步确认需要手动点击，成功率较高，但是速度较发包模式慢；发包模式理论速度最快，但是需要cookie，并且不保证成功率">
                                        <TextBlock Text="?"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontWeight="Bold"
                                                   FontSize="20"
                                                   Foreground="White"/>
                                    </Border>
                                </Grid>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- 账户信息配置 -->
                    <Border Classes="collapsible-card" HorizontalAlignment="Stretch">
                        <Grid RowDefinitions="Auto,Auto">
                            <Button Grid.Row="0" 
                                    Classes="collapse-header"
                                    Click="OnAccountToggle"
                                    x:Name="AccountToggleSingle">
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <TextBlock Text="👤" FontSize="20" VerticalAlignment="Center"/>
                                    <TextBlock Text="账户信息配置" VerticalAlignment="Center"/>
                                    <TextBlock Text="▶" 
                                               x:Name="AccountIconSingle"
                                               FontSize="14" 
                                               VerticalAlignment="Center" 
                                               Foreground="{DynamicResource ThemeTextSecondary}"/>
                                </StackPanel>
                            </Button>

                            <StackPanel Grid.Row="1" 
                                        x:Name="AccountContentSingle"
                                        Spacing="20" 
                                        Margin="24,0,24,24"
                                        IsVisible="False">
                                <Grid RowDefinitions="Auto,Auto,Auto,Auto" 
                                      ColumnDefinitions="180,*,Auto"
                                      HorizontalAlignment="Stretch">
                                    <!-- 用户账号 -->
                                    <TextBlock Grid.Row="0" Grid.Column="0" 
                                               Classes="modern-label"
                                               Text="用户账号"
                                               VerticalAlignment="Center"
                                               Margin="0,0,24,0"/>
                                    <TextBox Grid.Row="0" Grid.Column="1" 
                                             Text="{Binding UserAccount}"
                                             IsEnabled="{Binding !IsRunning}"
                                             Watermark="请输入用户账号"
                                             Margin="0,0,24,16"
                                             HorizontalAlignment="Stretch"/>

                                    <!-- 用户密码 -->
                                    <TextBlock Grid.Row="1" Grid.Column="0" 
                                               Classes="modern-label"
                                               Text="用户密码"
                                               VerticalAlignment="Center"
                                               Margin="0,0,24,0"/>
                                    <TextBox Grid.Row="1" Grid.Column="1" 
                                             Text="{Binding UserPassword}"
                                             IsEnabled="{Binding !IsRunning}"
                                             PasswordChar="●"
                                             Watermark="请输入用户密码"
                                             Margin="0,0,24,16"
                                             HorizontalAlignment="Stretch"/>

                                    <!-- Cookie -->
                                    <TextBlock Grid.Row="2" Grid.Column="0" 
                                               Classes="modern-label"
                                               Text="Cookie"
                                               VerticalAlignment="Center"
                                               Margin="0,0,24,0"/>
                                    <TextBox Grid.Row="2" Grid.Column="1" 
                                             Text="{Binding Cookie}"
                                             IsEnabled="{Binding !IsRunning}"
                                             Watermark="请输入Cookie(Http发包模式必填)"
                                             Margin="0,0,24,16"
                                             HorizontalAlignment="Stretch"/>
                                    <Border Grid.Row="2" Grid.Column="2" 
                                            Classes="warning-icon"
                                            Width="36" Height="36" 
                                            VerticalAlignment="Center"
                                            ToolTip.Tip="如果填写了cookie不用填账号密码，获取方式：登陆一次后在浏览器设置里cookie查找ent.qpgzf.cn的cookie">
                                        <TextBlock Text="?"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontWeight="Bold"
                                                   FontSize="18"
                                                   Foreground="White"/>
                                    </Border>

                                    <!-- 申请人姓名 -->
                                    <TextBlock Grid.Row="3" Grid.Column="0" 
                                               Classes="modern-label"
                                               Text="申请人姓名"
                                               VerticalAlignment="Center"
                                               Margin="0,0,24,0"/>
                                    <TextBox Grid.Row="3" Grid.Column="1" 
                                             Text="{Binding ApplierName}"
                                             IsEnabled="{Binding !IsRunning}"
                                             Watermark="请输入申请人姓名"
                                             HorizontalAlignment="Stretch"/>
                                </Grid>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- 执行参数配置 -->
                    <Border Classes="collapsible-card" HorizontalAlignment="Stretch">
                        <Grid RowDefinitions="Auto,Auto">
                            <Button Grid.Row="0" 
                                    Classes="collapse-header"
                                    Click="OnExecutionToggle"
                                    x:Name="ExecutionToggleSingle">
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <TextBlock Text="⏰" FontSize="20" VerticalAlignment="Center"/>
                                    <TextBlock Text="执行参数配置" VerticalAlignment="Center"/>
                                    <TextBlock Text="▶" 
                                               x:Name="ExecutionIconSingle"
                                               FontSize="14" 
                                               VerticalAlignment="Center" 
                                               Foreground="{DynamicResource ThemeTextSecondary}"/>
                                </StackPanel>
                            </Button>

                            <StackPanel Grid.Row="1" 
                                        x:Name="ExecutionContentSingle"
                                        Spacing="16" 
                                        Margin="24,0,24,24"
                                        IsVisible="False">
                                <!-- 开始时间 -->
                                <StackPanel Spacing="8">
                                    <TextBlock Classes="modern-label" Text="开始时间"/>
                                    <StackPanel Orientation="Horizontal" Spacing="12">
                                        <CalendarDatePicker SelectedDate="{Binding StartDate}" Width="200" IsEnabled="{Binding !IsRunning}"/>
                                        <TextBox Text="{Binding StartHour}" Width="80" Watermark="时" IsEnabled="{Binding !IsRunning}"/>
                                        <TextBlock Text=":" VerticalAlignment="Center" FontWeight="Bold" FontSize="16" Foreground="{DynamicResource ThemeTextPrimary}"/>
                                        <TextBox Text="{Binding StartMinute}" Width="80" Watermark="分" IsEnabled="{Binding !IsRunning}"/>
                                        <TextBlock Text=":" VerticalAlignment="Center" FontWeight="Bold" FontSize="16" Foreground="{DynamicResource ThemeTextPrimary}"/>
                                        <TextBox Text="{Binding StartSecond}" Width="80" Watermark="秒" IsEnabled="{Binding !IsRunning}"/>
                                    </StackPanel>
                                </StackPanel>

                                <!-- 触发间隔和自动确认 -->
                                <Grid ColumnDefinitions="*,*" HorizontalAlignment="Stretch">
                                    <StackPanel Grid.Column="0" Spacing="8">
                                        <TextBlock Classes="modern-label" Text="触发间隔(ms)"/>
                                        <TextBox Text="{Binding ClickInterval}" 
                                                 IsEnabled="{Binding !IsRunning}"
                                                 HorizontalAlignment="Stretch"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="1" Spacing="8" Margin="24,0,0,0">
                                        <TextBlock Classes="modern-label" Text="自动确定最后一步"/>
                                        <StackPanel Orientation="Horizontal" Spacing="16">
                                            <CheckBox IsChecked="{Binding AutoConfirm}"
                                                      IsEnabled="{Binding !IsRunning}"
                                                      VerticalAlignment="Center"/>
                                            <Border Classes="danger-icon"
                                                    Width="32" Height="32" 
                                                    VerticalAlignment="Center"
                                                    ToolTip.Tip="慎重选择！如果选中，程序会自动点击最后一步抢房，如果不选中，程序会停在最后一步，需要手动点击确认">
                                                <TextBlock Text="!"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"
                                                           FontWeight="Bold"
                                                           FontSize="18"
                                                           Foreground="White"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- 社区条件设置 -->
                    <Border Classes="collapsible-card" HorizontalAlignment="Stretch">
                        <Grid RowDefinitions="Auto,Auto">
                            <Button Grid.Row="0" 
                                    Classes="collapse-header"
                                    Click="OnCommunityToggle"
                                    x:Name="CommunityToggleSingle">
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <TextBlock Text="🏘️" FontSize="20" VerticalAlignment="Center"/>
                                    <TextBlock Text="社区条件设置" VerticalAlignment="Center"/>
                                    <Border Classes="success-icon"
                                            Width="28" Height="28" 
                                            VerticalAlignment="Center"
                                            Margin="12,0,0,0"
                                            ToolTip.Tip="小区为必填，层数可以范围选择，例如2-4,6(注意要英文逗号)，层数不填即不筛选，其他如果填0则默认为不筛选">
                                        <TextBlock Text="?"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontWeight="Bold"
                                                   FontSize="14"
                                                   Foreground="White"/>
                                    </Border>
                                    <TextBlock Text="▶" 
                                               x:Name="CommunityIconSingle"
                                               FontSize="14" 
                                               VerticalAlignment="Center" 
                                               Foreground="{DynamicResource ThemeTextSecondary}"/>
                                </StackPanel>
                            </Button>

                            <StackPanel Grid.Row="1" 
                                        x:Name="CommunityContentSingle"
                                        Spacing="20" 
                                        Margin="24,0,24,24"
                                        IsVisible="False">
                                <Button Classes="modern-primary" 
                                        Content="➕ 添加条件" 
                                        Command="{Binding AddCommunityCommand}" 
                                        IsEnabled="{Binding !IsRunning}"
                                        HorizontalAlignment="Left"/>

                                <!-- 单列布局DataGrid -->
                                <DataGrid Classes="modern"
                                          ItemsSource="{Binding CommunityConditions}"
                                          CanUserReorderColumns="False"
                                          CanUserResizeColumns="False"
                                          CanUserSortColumns="False"
                                          GridLinesVisibility="None"
                                          HeadersVisibility="Column"
                                          MinHeight="200"
                                          Background="Transparent"
                                          BorderThickness="0"
                                          CornerRadius="12"
                                          AutoGenerateColumns="False"
                                          IsEnabled="{Binding !IsRunning}"
                                          Margin="0,8"
                                          HorizontalAlignment="Stretch">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="小区名称" Binding="{Binding CommunityName}" Width="2*" MinWidth="150" CanUserSort="False"/>
                                        <DataGridTextColumn Header="幢号" Binding="{Binding BuildingNo}" Width="1*" MinWidth="80" CanUserSort="False"/>
                                        <DataGridTextColumn Header="层数" Binding="{Binding FloorRange}" Width="1*" MinWidth="100" CanUserSort="False"/>
                                        <DataGridTextColumn Header="价格" Binding="{Binding MaxPrice}" Width="1*" MinWidth="100" CanUserSort="False"/>
                                        <DataGridTextColumn Header="面积" Binding="{Binding LeastArea}" Width="1*" MinWidth="100" CanUserSort="False"/>
                                        <DataGridTemplateColumn Header="房型" Width="1*" MinWidth="100" CanUserSort="False">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <ComboBox SelectedItem="{Binding HouseTypeDescription}"
                                                              ItemsSource="{Binding $parent[Window].DataContext.HouseTypes}"
                                                              HorizontalAlignment="Stretch"
                                                              Margin="4,2"
                                                              FontSize="12"
                                                              BorderThickness="1"
                                                              Padding="6,4"
                                                              IsEnabled="{Binding $parent[Window].DataContext.IsRunning, Converter={StaticResource BoolToInverseConverter}}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="操作" Width="120" MinWidth="100" CanUserSort="False">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Classes="modern-danger" 
                                                            Content="删除" 
                                                            FontSize="12"
                                                            Padding="8,4"
                                                            Command="{Binding $parent[Window].DataContext.DeleteCommunityCommand}"
                                                            CommandParameter="{Binding}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </Grid>
                    </Border>
                </StackPanel>
                
                <!-- 双列布局 (窗口宽度 >= 1200px) -->
                <Grid x:Name="DoubleColumnLayout" 
                      IsVisible="False"
                      HorizontalAlignment="Stretch">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="600"/>
                        <ColumnDefinition Width="20"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- 左侧配置面板 -->
                    <StackPanel Grid.Column="0" Spacing="0">

                        <!-- 运行模式配置 -->
                        <Border Classes="collapsible-card">
                            <Grid RowDefinitions="Auto,Auto">
                                <Button Grid.Row="0" 
                                        Classes="collapse-header"
                                        Click="OnOperationModeToggle"
                                        x:Name="OperationModeToggle">
                                    <StackPanel Orientation="Horizontal" Spacing="16">
                                        <TextBlock Text="🚀" FontSize="20" VerticalAlignment="Center"/>
                                        <TextBlock Text="运行模式配置" VerticalAlignment="Center"/>
                                        <TextBlock Text="▼" 
                                                   x:Name="OperationModeIcon"
                                                   FontSize="14" 
                                                   VerticalAlignment="Center" 
                                                   Foreground="{DynamicResource ThemeTextSecondary}"/>
                                    </StackPanel>
                                </Button>

                                <StackPanel Grid.Row="1" 
                                            x:Name="OperationModeContent"
                                            Spacing="20" 
                                            Margin="24,0,24,24">
                                    <StackPanel Orientation="Horizontal" Spacing="24">
                                        <StackPanel Spacing="8">
                                            <TextBlock Classes="modern-label" Text="运行模式"/>
                                            <ComboBox Width="240" 
                                                      SelectedIndex="{Binding SelectedOperationMode}"
                                                      ItemsSource="{Binding OperationModes}"
                                                      IsEnabled="{Binding !IsRunning}"
                                                      ToolTip.Tip="模拟点击模式可以看到具体的操作，在最后一步确认需要手动点击，成功率较高，但是速度较发包模式慢；发包模式理论速度最快，但是需要cookie，并且不保证成功率"/>
                                        </StackPanel>

                                        <StackPanel Spacing="8">
                                            <TextBlock Classes="modern-label" Text="浏览器类型"/>
                                            <ComboBox Width="180" 
                                                      SelectedIndex="{Binding SelectedBrowserType}"
                                                      ItemsSource="{Binding BrowserTypes}"
                                                      IsEnabled="{Binding !IsRunning}"/>
                                        </StackPanel>

                                        <Border Classes="info-icon"
                                                Width="40" Height="40" 
                                                VerticalAlignment="Bottom"
                                                Margin="12,0,0,0"
                                                ToolTip.Tip="模拟点击模式可以看到具体的操作，在最后一步确认需要手动点击，成功率较高，但是速度较发包模式慢；发包模式理论速度最快，但是需要cookie，并且不保证成功率">
                                            <TextBlock Text="?"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontWeight="Bold"
                                                       FontSize="20"
                                                       Foreground="White"/>
                                        </Border>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- 账户信息配置 -->
                        <Border Classes="collapsible-card">
                            <Grid RowDefinitions="Auto,Auto">
                                <Button Grid.Row="0" 
                                        Classes="collapse-header"
                                        Click="OnAccountToggle"
                                        x:Name="AccountToggle">
                                    <StackPanel Orientation="Horizontal" Spacing="16">
                                        <TextBlock Text="👤" FontSize="20" VerticalAlignment="Center"/>
                                        <TextBlock Text="账户信息配置" VerticalAlignment="Center"/>
                                        <TextBlock Text="▶" 
                                                   x:Name="AccountIcon"
                                                   FontSize="14" 
                                                   VerticalAlignment="Center" 
                                                   Foreground="{DynamicResource ThemeTextSecondary}"/>
                                    </StackPanel>
                                </Button>

                                <StackPanel Grid.Row="1" 
                                            x:Name="AccountContent"
                                            Spacing="20" 
                                            Margin="24,0,24,24"
                                            IsVisible="False">
                                    <Grid RowDefinitions="Auto,Auto,Auto,Auto" ColumnDefinitions="160,*,Auto">
                                        <!-- 用户账号 -->
                                        <TextBlock Grid.Row="0" Grid.Column="0" 
                                                   Classes="modern-label"
                                                   Text="用户账号"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,24,0"/>
                                        <TextBox Grid.Row="0" Grid.Column="1" 
                                                 Text="{Binding UserAccount}"
                                                 IsEnabled="{Binding !IsRunning}"
                                                 Watermark="请输入用户账号"
                                                 Margin="0,0,24,16"/>

                                        <!-- 用户密码 -->
                                        <TextBlock Grid.Row="1" Grid.Column="0" 
                                                   Classes="modern-label"
                                                   Text="用户密码"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,24,0"/>
                                        <TextBox Grid.Row="1" Grid.Column="1" 
                                                 Text="{Binding UserPassword}"
                                                 IsEnabled="{Binding !IsRunning}"
                                                 PasswordChar="●"
                                                 Watermark="请输入用户密码"
                                                 Margin="0,0,24,16"/>

                                        <!-- Cookie -->
                                        <TextBlock Grid.Row="2" Grid.Column="0" 
                                                   Classes="modern-label"
                                                   Text="Cookie"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,24,0"/>
                                        <TextBox Grid.Row="2" Grid.Column="1" 
                                                 Text="{Binding Cookie}"
                                                 IsEnabled="{Binding !IsRunning}"
                                                 Watermark="请输入Cookie(Http发包模式必填)"
                                                 Margin="0,0,24,16"/>
                                        <Border Grid.Row="2" Grid.Column="2" 
                                                Classes="warning-icon"
                                                Width="36" Height="36" 
                                                VerticalAlignment="Center"
                                                ToolTip.Tip="如果填写了cookie不用填账号密码，获取方式：登陆一次后在浏览器设置里cookie查找ent.qpgzf.cn的cookie">
                                            <TextBlock Text="?"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontWeight="Bold"
                                                       FontSize="18"
                                                       Foreground="White"/>
                                        </Border>

                                        <!-- 申请人姓名 -->
                                        <TextBlock Grid.Row="3" Grid.Column="0" 
                                                   Classes="modern-label"
                                                   Text="申请人姓名"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,24,0"/>
                                        <TextBox Grid.Row="3" Grid.Column="1" 
                                                 Text="{Binding ApplierName}"
                                                 IsEnabled="{Binding !IsRunning}"
                                                 Watermark="请输入申请人姓名"/>
                                    </Grid>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- 执行参数配置 -->
                        <Border Classes="collapsible-card">
                            <Grid RowDefinitions="Auto,Auto">
                                <Button Grid.Row="0" 
                                        Classes="collapse-header"
                                        Click="OnExecutionToggle"
                                        x:Name="ExecutionToggle">
                                    <StackPanel Orientation="Horizontal" Spacing="16">
                                        <TextBlock Text="⏰" FontSize="20" VerticalAlignment="Center"/>
                                        <TextBlock Text="执行参数配置" VerticalAlignment="Center"/>
                                        <TextBlock Text="▶" 
                                                   x:Name="ExecutionIcon"
                                                   FontSize="14" 
                                                   VerticalAlignment="Center" 
                                                   Foreground="{DynamicResource ThemeTextSecondary}"/>
                                    </StackPanel>
                                </Button>

                                <StackPanel Grid.Row="1" 
                                            x:Name="ExecutionContent"
                                            Spacing="16" 
                                            Margin="24,0,24,24"
                                            IsVisible="False">
                                    <!-- 开始时间 -->
                                    <StackPanel Spacing="8">
                                        <TextBlock Classes="modern-label" Text="开始时间"/>
                                        <StackPanel Orientation="Horizontal" Spacing="12">
                                            <CalendarDatePicker SelectedDate="{Binding StartDate}" Width="160" IsEnabled="{Binding !IsRunning}"/>
                                            <TextBox Text="{Binding StartHour}" Width="60" Watermark="时" IsEnabled="{Binding !IsRunning}"/>
                                            <TextBlock Text=":" VerticalAlignment="Center" FontWeight="Bold" FontSize="16" Foreground="{DynamicResource ThemeTextPrimary}"/>
                                            <TextBox Text="{Binding StartMinute}" Width="60" Watermark="分" IsEnabled="{Binding !IsRunning}"/>
                                            <TextBlock Text=":" VerticalAlignment="Center" FontWeight="Bold" FontSize="16" Foreground="{DynamicResource ThemeTextPrimary}"/>
                                            <TextBox Text="{Binding StartSecond}" Width="60" Watermark="秒" IsEnabled="{Binding !IsRunning}"/>
                                        </StackPanel>
                                    </StackPanel>

                                    <!-- 触发间隔 -->
                                    <StackPanel Spacing="8">
                                        <TextBlock Classes="modern-label" Text="触发间隔(ms)"/>
                                        <TextBox Text="{Binding ClickInterval}" 
                                                 Width="140"
                                                 HorizontalAlignment="Left"
                                                 IsEnabled="{Binding !IsRunning}"/>
                                    </StackPanel>

                                    <!-- 自动确认 -->
                                    <StackPanel Spacing="8">
                                        <TextBlock Classes="modern-label" Text="自动确定最后一步"/>
                                        <StackPanel Orientation="Horizontal" Spacing="16">
                                            <CheckBox IsChecked="{Binding AutoConfirm}"
                                                      IsEnabled="{Binding !IsRunning}"
                                                      VerticalAlignment="Center"/>
                                            <Border Classes="danger-icon"
                                                    Width="32" Height="32" 
                                                    VerticalAlignment="Center"
                                                    ToolTip.Tip="慎重选择！如果选中，程序会自动点击最后一步抢房，如果不选中，程序会停在最后一步，需要手动点击确认">
                                                <TextBlock Text="!"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"
                                                           FontWeight="Bold"
                                                           FontSize="18"
                                                           Foreground="White"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </StackPanel>
                    
                    <!-- 右侧社区条件设置面板 -->
                    <Border Grid.Column="2" Classes="collapsible-card">
                        <Grid RowDefinitions="Auto,Auto">
                            <Button Grid.Row="0" 
                                    Classes="collapse-header"
                                    Click="OnCommunityToggle"
                                    x:Name="CommunityToggle">
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <TextBlock Text="🏘️" FontSize="20" VerticalAlignment="Center"/>
                                    <TextBlock Text="社区条件设置" VerticalAlignment="Center"/>
                                    <Border Classes="success-icon"
                                            Width="28" Height="28" 
                                            VerticalAlignment="Center"
                                            Margin="12,0,0,0"
                                            ToolTip.Tip="小区为必填，层数可以范围选择，例如2-4,6(注意要英文逗号)，层数不填即不筛选，其他如果填0则默认为不筛选">
                                        <TextBlock Text="?"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontWeight="Bold"
                                                   FontSize="14"
                                                   Foreground="White"/>
                                    </Border>
                                    <TextBlock Text="▶" 
                                               x:Name="CommunityIcon"
                                               FontSize="14" 
                                               VerticalAlignment="Center" 
                                               Foreground="{DynamicResource ThemeTextSecondary}"/>
                                </StackPanel>
                            </Button>

                            <StackPanel Grid.Row="1" 
                                        x:Name="CommunityContent"
                                        Spacing="20" 
                                        Margin="24,0,24,24"
                                        IsVisible="False">
                                <Button Classes="modern-primary" 
                                        Content="➕ 添加条件" 
                                        Command="{Binding AddCommunityCommand}" 
                                        IsEnabled="{Binding !IsRunning}"
                                        HorizontalAlignment="Left"/>

                                <!-- 双列布局的完全响应式DataGrid -->
                                <DataGrid Classes="modern"
                                          ItemsSource="{Binding CommunityConditions}"
                                          CanUserReorderColumns="False"
                                          CanUserResizeColumns="False"
                                          CanUserSortColumns="False"
                                          GridLinesVisibility="None"
                                          HeadersVisibility="Column"
                                          MinHeight="200"
                                          Background="Transparent"
                                          BorderThickness="0"
                                          CornerRadius="12"
                                          AutoGenerateColumns="False"
                                          IsEnabled="{Binding !IsRunning}"
                                          Margin="0,8"
                                          HorizontalAlignment="Stretch">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="小区名称" Binding="{Binding CommunityName}" Width="*" MinWidth="120" CanUserSort="False"/>
                                        <DataGridTextColumn Header="幢号" Binding="{Binding BuildingNo}" Width="80" MinWidth="60" CanUserSort="False"/>
                                        <DataGridTextColumn Header="层数" Binding="{Binding FloorRange}" Width="100" MinWidth="80" CanUserSort="False"/>
                                        <DataGridTextColumn Header="价格" Binding="{Binding MaxPrice}" Width="120" MinWidth="100" CanUserSort="False"/>
                                        <DataGridTextColumn Header="面积" Binding="{Binding LeastArea}" Width="120" MinWidth="100" CanUserSort="False"/>
                                        <DataGridTemplateColumn Header="房型" Width="100" MinWidth="80" CanUserSort="False">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <ComboBox SelectedItem="{Binding HouseTypeDescription}"
                                                              ItemsSource="{Binding $parent[Window].DataContext.HouseTypes}"
                                                              HorizontalAlignment="Stretch"
                                                              Margin="4,2"
                                                              FontSize="12"
                                                              BorderThickness="1"
                                                              Padding="6,4"
                                                              IsEnabled="{Binding $parent[Window].DataContext.IsRunning, Converter={StaticResource BoolToInverseConverter}}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="操作" Width="90" MinWidth="80" CanUserSort="False">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Classes="modern-danger" 
                                                            Content="删除" 
                                                            FontSize="12"
                                                            Padding="8,4"
                                                            Command="{Binding $parent[Window].DataContext.DeleteCommunityCommand}"
                                                            CommandParameter="{Binding}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </Panel>
        </ScrollViewer>

        <!-- 固定的日志输出区域 - 可手动拖拽调整高度 -->
        <Border Grid.Row="2" 
                Classes="modern-card"
                Margin="16,16,16,0"
                x:Name="LogArea"
                Height="260"
                MinHeight="120"
                MaxHeight="600">
            <Grid RowDefinitions="Auto,Auto,*">
                <!-- 拖拽手柄区域 -->
                <Border Grid.Row="0" 
                        Height="8" 
                        Background="Transparent"
                        Cursor="SizeNorthSouth"
                        x:Name="ResizeHandle">
                    <Border Height="3" 
                            Background="{DynamicResource ThemeBorder}" 
                            CornerRadius="2" 
                            Margin="40,0"
                            Opacity="0.6"/>
                </Border>
                
                <!-- 标题区域 -->
                <StackPanel Grid.Row="1" 
                            Orientation="Horizontal" 
                            Spacing="16" 
                            Margin="0,8,0,16">
                    <TextBlock Text="📋" FontSize="20" VerticalAlignment="Center"/>
                    <TextBlock Classes="modern-title" Text="日志输出" FontSize="22"/>
                </StackPanel>
                
                <!-- 日志内容区域 -->
                <ScrollViewer Grid.Row="2" 
                              VerticalScrollBarVisibility="Auto" 
                              HorizontalScrollBarVisibility="Disabled"
                              x:Name="LogScrollViewer">
                    <TextBox Classes="modern-log"
                             Text="{Binding LogText}"
                             IsReadOnly="True"
                             AcceptsReturn="True"
                             TextWrapping="Wrap"
                             x:Name="LogTextBox"/>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- 固定的操作按钮区域 - 响应式设计 -->
        <Border Grid.Row="3" 
                BorderBrush="{DynamicResource ThemeBorder}" 
                BorderThickness="0,1,0,0"
                Padding="16,20"
                x:Name="FooterBorder">
            <Border.Background>
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                    <GradientStop Color="#FFFFFF" Offset="0"/>
                    <GradientStop Color="#F8F9FA" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Grid MaxWidth="1000" HorizontalAlignment="Center">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" MaxWidth="160"/>
                    <ColumnDefinition Width="*" MaxWidth="160"/>
                    <ColumnDefinition Width="Auto" MaxWidth="200"/>
                    <ColumnDefinition Width="160"/>
                </Grid.ColumnDefinitions>
                
                <Button Grid.Column="0"
                        Classes="modern-primary" 
                        Content="🚀 开始抢房" 
                        Command="{Binding StartProcessCommand}"
                        IsEnabled="{Binding !IsRunning}"
                        Margin="0,0,8,0"
                        FontSize="15"/>
                
                <Button Grid.Column="1"
                        Classes="modern-secondary" 
                        Content="⏹️ 停止抢房" 
                        Command="{Binding StopProcessCommand}"
                        IsEnabled="{Binding IsRunning}"
                        Margin="4,0,4,0"
                        FontSize="15"/>
                
                <Button Grid.Column="2"
                        Classes="modern-secondary" 
                        Content="🔍 获取房间ID" 
                        Command="{Binding FetchRoomIdsCommand}"
                        Margin="8,0,16,0"
                        FontSize="15"
                        ToolTip.Tip="提前获取所有符合条件的房间ID，加速抢房">
                    <Button.IsVisible>
                        <Binding Path="SelectedOperationMode" Converter="{StaticResource IntToBoolConverter}" ConverterParameter="1"/>
                    </Button.IsVisible>
                    <Button.IsEnabled>
                        <MultiBinding Converter="{StaticResource MultiBoolConverter}">
                            <Binding Path="!IsRunning"/>
                            <Binding Path="!IsFetchingRoomIds"/>
                        </MultiBinding>
                    </Button.IsEnabled>
                </Button>
                
                <Button Grid.Column="3"
                        Classes="github-icon" 
                        Content="G" 
                        Command="{Binding OpenGitHubCommand}"
                        ToolTip.Tip="访问GitHub"/>
            </Grid>
        </Border>

    </Grid>

</Window>
