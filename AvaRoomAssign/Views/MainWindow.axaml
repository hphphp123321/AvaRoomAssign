<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:AvaRoomAssign.ViewModels"
        xmlns:models="using:AvaRoomAssign.Models"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="950"
        x:Class="AvaRoomAssign.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/house.ico"
        Title="æŠ¢æˆ¿å¥½å¥½å¥½ - Avaloniaç‰ˆ Ver 2.0.0 By: hp"
        Width="1000" Height="950"
        MinWidth="1000" MinHeight="700"
        WindowStartupLocation="CenterScreen"
        CanResize="true">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Window.Resources>
        <models:BoolToInverseBoolConverter x:Key="BoolToInverseConverter"/>
        <models:IntToBoolConverter x:Key="IntToBoolConverter"/>
        <models:MultiBoolConverter x:Key="MultiBoolConverter"/>
        
        <!-- æµ…è‰²ä¸»é¢˜èµ„æº - çŽ°ä»£æ¸…æ–°é…è‰² -->
        <SolidColorBrush x:Key="ThemeBackground" Color="#F7F9FC"/>
        <SolidColorBrush x:Key="ThemeCardBackground" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="ThemeTextPrimary" Color="#1A202C"/>
        <SolidColorBrush x:Key="ThemeTextSecondary" Color="#718096"/>
        <SolidColorBrush x:Key="ThemeBorder" Color="#E2E8F0"/>
        <SolidColorBrush x:Key="ThemeAccent" Color="#4299E1"/>
        <SolidColorBrush x:Key="ThemeAccentHover" Color="#3182CE"/>
        <SolidColorBrush x:Key="ThemeSuccess" Color="#48BB78"/>
        <SolidColorBrush x:Key="ThemeWarning" Color="#ED8936"/>
        <SolidColorBrush x:Key="ThemeDanger" Color="#F56565"/>
        <SolidColorBrush x:Key="ThemeLogBackground" Color="#F7FAFC"/>
        <SolidColorBrush x:Key="ThemeLogText" Color="#38A169"/>
        <!-- è¡¨æ ¼ç›¸å…³é¢œè‰² -->
        <SolidColorBrush x:Key="ThemeTableAlternating" Color="#F7FAFC"/>
        <SolidColorBrush x:Key="ThemeTableHover" Color="#EBF8FF"/>
        <SolidColorBrush x:Key="ThemeTableSelected" Color="#BEE3F8"/>
        
        <!-- æ·±è‰²ä¸»é¢˜èµ„æº - æ·±é‚ƒçŽ°ä»£é…è‰² -->
        <SolidColorBrush x:Key="DarkThemeBackground" Color="#0F1419"/>
        <SolidColorBrush x:Key="DarkThemeCardBackground" Color="#1A202C"/>
        <SolidColorBrush x:Key="DarkThemeTextPrimary" Color="#F7FAFC"/>
        <SolidColorBrush x:Key="DarkThemeTextSecondary" Color="#A0AEC0"/>
        <SolidColorBrush x:Key="DarkThemeBorder" Color="#2D3748"/>
        <SolidColorBrush x:Key="DarkThemeAccent" Color="#63B3ED"/>
        <SolidColorBrush x:Key="DarkThemeAccentHover" Color="#90CDF4"/>
        <SolidColorBrush x:Key="DarkThemeSuccess" Color="#68D391"/>
        <SolidColorBrush x:Key="DarkThemeWarning" Color="#F6AD55"/>
        <SolidColorBrush x:Key="DarkThemeDanger" Color="#FC8181"/>
        <SolidColorBrush x:Key="DarkThemeLogBackground" Color="#171923"/>
        <SolidColorBrush x:Key="DarkThemeLogText" Color="#9AE6B4"/>
        <!-- æ·±è‰²ä¸»é¢˜è¡¨æ ¼ç›¸å…³é¢œè‰² -->
        <SolidColorBrush x:Key="DarkThemeTableAlternating" Color="#2D3748"/>
        <SolidColorBrush x:Key="DarkThemeTableHover" Color="#4A5568"/>
        <SolidColorBrush x:Key="DarkThemeTableSelected" Color="#3182CE"/>
    </Window.Resources>

    <Window.Styles>
        <!-- å¡ç‰‡æ ·å¼ -->
        <Style Selector="Border.modern-card">
            <Setter Property="Background" Value="{DynamicResource ThemeCardBackground}"/>
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="Padding" Value="24"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#10000000" OffsetX="0" OffsetY="4" BlurRadius="20"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- å¯æŠ˜å å¡ç‰‡æ ·å¼ -->
        <Style Selector="Border.collapsible-card">
            <Setter Property="Background" Value="{DynamicResource ThemeCardBackground}"/>
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#08000000" OffsetX="0" OffsetY="2" BlurRadius="12"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- æŠ˜å é¢æ¿å¤´éƒ¨æ ·å¼ -->
        <Style Selector="Button.collapse-header">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="CornerRadius" Value="16,16,0,0"/>
            <Setter Property="Padding" Value="24,20"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
        </Style>

        <Style Selector="Button.collapse-header:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeTableHover}"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <Style Selector="Button.collapse-header:pressed /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeTableSelected}"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <!-- ä¸»è¦æŒ‰é’®æ ·å¼ - ä½¿ç”¨ä¸»é¢˜è‰² -->
        <Style Selector="Button.modern-primary">
            <Setter Property="Background" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20,14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#40000000" OffsetX="0" OffsetY="2" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style Selector="Button.modern-primary:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeAccentHover}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,14"/>
        </Style>

        <Style Selector="Button.modern-primary:pressed /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeAccentHover}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,14"/>
            <Setter Property="Opacity" Value="0.8"/>
        </Style>

        <Style Selector="Button.modern-primary:disabled /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextSecondary}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,14"/>
        </Style>

        <!-- æ¬¡è¦æŒ‰é’®æ ·å¼ -->
        <Style Selector="Button.modern-secondary">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20,14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccent}"/>
        </Style>

        <Style Selector="Button.modern-secondary:pointerover">
            <Setter Property="Background" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="Padding" Value="20,14"/>
        </Style>

        <!-- å±é™©æŒ‰é’®æ ·å¼ -->
        <Style Selector="Button.modern-danger">
            <Setter Property="Background" Value="{DynamicResource ThemeDanger}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <Style Selector="Button.modern-danger:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeDanger}"/>
            <Setter Property="Opacity" Value="0.8"/>
        </Style>

        <!-- ä¸»é¢˜åˆ‡æ¢æŒ‰é’® -->
        <Style Selector="Button.theme-toggle">
            <Setter Property="Background" Value="{DynamicResource ThemeWarning}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="CornerRadius" Value="24"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="48"/>
            <Setter Property="Height" Value="48"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#40000000" OffsetX="0" OffsetY="2" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style Selector="Button.theme-toggle:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeWarning}"/>
            <Setter Property="Opacity" Value="0.8"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>

        <!-- GitHubå›¾æ ‡æŒ‰é’®æ ·å¼ -->
        <Style Selector="Button.github-icon">
            <Setter Property="Background" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeCardBackground}"/>
            <Setter Property="CornerRadius" Value="24"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="48"/>
            <Setter Property="Height" Value="48"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#40000000" OffsetX="0" OffsetY="2" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style Selector="Button.github-icon:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource ThemeTextSecondary}"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>

        <!-- æ ‡ç­¾æ ·å¼ -->
        <Style Selector="TextBlock.modern-label">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>

        <!-- æ ‡é¢˜æ ·å¼ -->
        <Style Selector="TextBlock.modern-title">
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="28"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
        </Style>

        <!-- å‰¯æ ‡é¢˜æ ·å¼ -->
        <Style Selector="TextBlock.modern-subtitle">
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextSecondary}"/>
        </Style>

        <!-- æ—¥å¿—æ–‡æœ¬æ¡†æ ·å¼ -->
        <Style Selector="TextBox.modern-log">
            <Setter Property="Background" Value="{DynamicResource ThemeLogBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeLogText}"/>
            <Setter Property="FontFamily" Value="Consolas, 'SF Mono', 'Monaco', 'Menlo', monospace"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeSuccess}"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="MinHeight" Value="60"/>
            <Setter Property="VerticalAlignment" Value="Stretch"/>
            <Setter Property="VerticalContentAlignment" Value="Top"/>
        </Style>

        <!-- DataGridæ ·å¼ - çŽ°ä»£åŒ–è®¾è®¡ -->
        <Style Selector="DataGrid.modern">
            <Setter Property="Background" Value="{DynamicResource ThemeCardBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="RowBackground" Value="Transparent"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="GridLinesVisibility" Value="None"/>
            <Setter Property="CanUserReorderColumns" Value="False"/>
            <Setter Property="CanUserSortColumns" Value="False"/>
            <Setter Property="CanUserResizeColumns" Value="False"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="RowHeight" Value="48"/>
        </Style>

        <!-- DataGrid Headeræ ·å¼ -->
        <Style Selector="DataGrid.modern DataGridColumnHeader">
            <Setter Property="Background" Value="{DynamicResource ThemeTableAlternating}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Height" Value="44"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Border Background="{DynamicResource ThemeTableAlternating}"
                                BorderBrush="{DynamicResource ThemeBorder}"
                                BorderThickness="0,0,1,1"
                                CornerRadius="{TemplateBinding CornerRadius}">
                            <ContentPresenter Content="{TemplateBinding Content}"
                                              ContentTemplate="{TemplateBinding ContentTemplate}"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              Margin="12,14"
                                              TextBlock.Foreground="{DynamicResource ThemeTextPrimary}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ç¬¬ä¸€ä¸ªè¡¨å¤´çš„åœ†è§’ -->
        <Style Selector="DataGrid.modern DataGridColumnHeader:nth-child(1)">
            <Setter Property="CornerRadius" Value="12,0,0,0"/>
        </Style>

        <!-- æœ€åŽä¸€ä¸ªè¡¨å¤´çš„åœ†è§’ -->
        <Style Selector="DataGrid.modern DataGridColumnHeader:last-child">
            <Setter Property="CornerRadius" Value="0,12,0,0"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
        </Style>

        <!-- DataGrid Rowæ ·å¼ -->
        <Style Selector="DataGrid.modern DataGridRow">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="MinHeight" Value="48"/>
        </Style>

        <!-- DataGrid äº¤æ›¿è¡ŒèƒŒæ™¯ -->
        <Style Selector="DataGrid.modern DataGridRow:nth-child(even)">
            <Setter Property="Background" Value="{DynamicResource ThemeTableAlternating}"/>
        </Style>

        <!-- DataGrid æ‚¬åœæ•ˆæžœ -->
        <Style Selector="DataGrid.modern DataGridRow:pointerover">
            <Setter Property="Background" Value="{DynamicResource ThemeTableHover}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
        </Style>

        <!-- DataGrid é€‰ä¸­æ•ˆæžœ -->
        <Style Selector="DataGrid.modern DataGridRow:selected">
            <Setter Property="Background" Value="{DynamicResource ThemeTableSelected}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
        </Style>

        <!-- DataGrid é€‰ä¸­ä¸”æ‚¬åœ -->
        <Style Selector="DataGrid.modern DataGridRow:selected:pointerover">
            <Setter Property="Background" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
        </Style>

        <!-- DataGrid Cellæ ·å¼ -->
        <Style Selector="DataGrid.modern DataGridCell">
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>
        
        <!-- DataGrid Cellå†…çš„TextBlockæ ·å¼ -->
        <Style Selector="DataGrid.modern DataGridCell TextBlock">
            <Setter Property="TextAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
            <Setter Property="ToolTip.Tip" Value="{Binding Text, RelativeSource={RelativeSource Self}}"/>
        </Style>

        <!-- ä¿¡æ¯å›¾æ ‡æ ·å¼ - ä½¿ç”¨ä¸»é¢˜è‰² -->
        <Style Selector="Border.info-icon">
            <Setter Property="Background" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="CornerRadius" Value="18"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#40000000" OffsetX="0" OffsetY="2" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style Selector="Border.warning-icon">
            <Setter Property="Background" Value="{DynamicResource ThemeWarning}"/>
            <Setter Property="CornerRadius" Value="18"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#40000000" OffsetX="0" OffsetY="2" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style Selector="Border.success-icon">
            <Setter Property="Background" Value="{DynamicResource ThemeSuccess}"/>
            <Setter Property="CornerRadius" Value="18"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#40000000" OffsetX="0" OffsetY="2" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style Selector="Border.danger-icon">
            <Setter Property="Background" Value="{DynamicResource ThemeDanger}"/>
            <Setter Property="CornerRadius" Value="18"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#40000000" OffsetX="0" OffsetY="2" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- è¾“å…¥æ¡†æ ·å¼ -->
        <Style Selector="TextBox">
            <Setter Property="Background" Value="{DynamicResource ThemeCardBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <Style Selector="TextBox:focus /template/ Border#PART_BorderElement">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="BorderThickness" Value="2"/>
        </Style>

        <!-- ä¸‹æ‹‰æ¡†æ ·å¼ -->
        <Style Selector="ComboBox">
            <Setter Property="Background" Value="{DynamicResource ThemeCardBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <Style Selector="ComboBox:focus /template/ Border#Background">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccent}"/>
        </Style>

        <!-- DataGridä¸­çš„ComboBoxæ ·å¼ -->
        <Style Selector="DataGrid.modern ComboBox">
            <Setter Property="Background" Value="{DynamicResource ThemeCardBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="MinHeight" Value="32"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style Selector="DataGrid.modern ComboBox:focus /template/ Border#Background">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <Style Selector="DataGrid.modern ComboBox:pointerover /template/ Border#Background">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="{DynamicResource ThemeTableHover}"/>
        </Style>

        <!-- å¤é€‰æ¡†æ ·å¼ -->
        <Style Selector="CheckBox">
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimary}"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <Style Selector="CheckBox /template/ Border#NormalRectangle">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorder}"/>
            <Setter Property="Background" Value="{DynamicResource ThemeCardBackground}"/>
        </Style>

        <Style Selector="CheckBox:checked /template/ Border#NormalRectangle">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccent}"/>
            <Setter Property="Background" Value="{DynamicResource ThemeAccent}"/>
        </Style>
    </Window.Styles>

    <Grid Background="{DynamicResource ThemeBackground}" x:Name="MainGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- é¡¶éƒ¨æ ‡é¢˜æ å’Œä¸»é¢˜åˆ‡æ¢ - å¢žåŠ æ¸å˜èƒŒæ™¯ -->
        <Border Grid.Row="0" 
                BorderBrush="{DynamicResource ThemeBorder}" 
                BorderThickness="0,0,0,1"
                Padding="24,24"
                x:Name="HeaderBorder">
            <Border.Background>
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                    <GradientStop Color="#FFFFFF" Offset="0"/>
                    <GradientStop Color="#F8F9FA" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Spacing="8">
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <TextBlock Classes="modern-title" Text="ðŸ " FontSize="32"/>
                        <TextBlock Classes="modern-title" Text="æŠ¢æˆ¿å¥½å¥½å¥½"/>
                    </StackPanel>
                    <TextBlock Classes="modern-subtitle" Text="Avaloniaç‰ˆ Ver 2.0.0 By: hp - è‡ªåŠ¨åŒ–æŠ¢å…¬ç§Ÿæˆ¿"/>
                </StackPanel>

                <Button Grid.Column="1" 
                        Classes="theme-toggle"
                        Content="ðŸŒ™"
                        ToolTip.Tip="åˆ‡æ¢ä¸»é¢˜"
                        Click="OnThemeToggleClick"
                        x:Name="ThemeToggleButton"/>
            </Grid>
        </Border>

        <!-- å¯æ»šåŠ¨çš„é…ç½®åŒºåŸŸ -->
        <ScrollViewer Grid.Row="1" 
                      VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled"
                      Padding="16,16,16,0"
                      x:Name="ConfigScrollViewer">
            <!-- å“åº”å¼å®¹å™¨ -->
            <Panel x:Name="ResponsiveContainer">
                <!-- å•åˆ—å¸ƒå±€ (é»˜è®¤, çª—å£å®½åº¦ < 1200px) -->
                <StackPanel x:Name="SingleColumnLayout" 
                           HorizontalAlignment="Stretch" 
                           Margin="0,0,0,0">
                    
                    <!-- è¿è¡Œæ¨¡å¼é…ç½® -->
                    <Border Classes="collapsible-card" HorizontalAlignment="Stretch">
                        <Grid RowDefinitions="Auto,Auto">
                            <Button Grid.Row="0" 
                                    Classes="collapse-header"
                                    Click="OnOperationModeToggle"
                                    x:Name="OperationModeToggleSingle">
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <TextBlock Text="ðŸš€" FontSize="20" VerticalAlignment="Center"/>
                                    <TextBlock Text="è¿è¡Œæ¨¡å¼é…ç½®" VerticalAlignment="Center"/>
                                    <TextBlock Text="â–¼" 
                                               x:Name="OperationModeIconSingle"
                                               FontSize="14" 
                                               VerticalAlignment="Center" 
                                               Foreground="{DynamicResource ThemeTextSecondary}"/>
                                </StackPanel>
                            </Button>

                            <StackPanel Grid.Row="1" 
                                        x:Name="OperationModeContentSingle"
                                        Spacing="20" 
                                        Margin="24,0,24,24">
                                <Grid ColumnDefinitions="*,*,Auto" HorizontalAlignment="Stretch">
                                    <StackPanel Grid.Column="0" Spacing="8" HorizontalAlignment="Stretch">
                                        <TextBlock Classes="modern-label" Text="è¿è¡Œæ¨¡å¼"/>
                                        <ComboBox SelectedIndex="{Binding SelectedOperationMode}"
                                                  ItemsSource="{Binding OperationModes}"
                                                  IsEnabled="{Binding !IsRunning}"
                                                  HorizontalAlignment="Stretch"
                                                  ToolTip.Tip="æ¨¡æ‹Ÿç‚¹å‡»æ¨¡å¼å¯ä»¥çœ‹åˆ°å…·ä½“çš„æ“ä½œï¼Œåœ¨æœ€åŽä¸€æ­¥ç¡®è®¤éœ€è¦æ‰‹åŠ¨ç‚¹å‡»ï¼ŒæˆåŠŸçŽ‡è¾ƒé«˜ï¼Œä½†æ˜¯é€Ÿåº¦è¾ƒå‘åŒ…æ¨¡å¼æ…¢ï¼›å‘åŒ…æ¨¡å¼ç†è®ºé€Ÿåº¦æœ€å¿«ï¼Œä½†æ˜¯éœ€è¦cookieï¼Œå¹¶ä¸”ä¸ä¿è¯æˆåŠŸçŽ‡"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="1" Spacing="8" Margin="24,0,0,0" HorizontalAlignment="Stretch">
                                        <TextBlock Classes="modern-label" Text="æµè§ˆå™¨ç±»åž‹"/>
                                        <ComboBox SelectedIndex="{Binding SelectedBrowserType}"
                                                  ItemsSource="{Binding BrowserTypes}"
                                                  IsEnabled="{Binding !IsRunning}"
                                                  HorizontalAlignment="Stretch"/>
                                    </StackPanel>

                                    <Border Grid.Column="2" Classes="info-icon"
                                            Width="40" Height="40" 
                                            VerticalAlignment="Bottom"
                                            Margin="24,0,0,0"
                                            ToolTip.Tip="æ¨¡æ‹Ÿç‚¹å‡»æ¨¡å¼å¯ä»¥çœ‹åˆ°å…·ä½“çš„æ“ä½œï¼Œåœ¨æœ€åŽä¸€æ­¥ç¡®è®¤éœ€è¦æ‰‹åŠ¨ç‚¹å‡»ï¼ŒæˆåŠŸçŽ‡è¾ƒé«˜ï¼Œä½†æ˜¯é€Ÿåº¦è¾ƒå‘åŒ…æ¨¡å¼æ…¢ï¼›å‘åŒ…æ¨¡å¼ç†è®ºé€Ÿåº¦æœ€å¿«ï¼Œä½†æ˜¯éœ€è¦cookieï¼Œå¹¶ä¸”ä¸ä¿è¯æˆåŠŸçŽ‡">
                                        <TextBlock Text="?"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontWeight="Bold"
                                                   FontSize="20"
                                                   Foreground="White"/>
                                    </Border>
                                </Grid>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- è´¦æˆ·ä¿¡æ¯é…ç½® -->
                    <Border Classes="collapsible-card" HorizontalAlignment="Stretch">
                        <Grid RowDefinitions="Auto,Auto">
                            <Button Grid.Row="0" 
                                    Classes="collapse-header"
                                    Click="OnAccountToggle"
                                    x:Name="AccountToggleSingle">
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <TextBlock Text="ðŸ‘¤" FontSize="20" VerticalAlignment="Center"/>
                                    <TextBlock Text="è´¦æˆ·ä¿¡æ¯é…ç½®" VerticalAlignment="Center"/>
                                    <TextBlock Text="â–¶" 
                                               x:Name="AccountIconSingle"
                                               FontSize="14" 
                                               VerticalAlignment="Center" 
                                               Foreground="{DynamicResource ThemeTextSecondary}"/>
                                </StackPanel>
                            </Button>

                            <StackPanel Grid.Row="1" 
                                        x:Name="AccountContentSingle"
                                        Spacing="20" 
                                        Margin="24,0,24,24"
                                        IsVisible="False">
                                <Grid RowDefinitions="Auto,Auto,Auto,Auto" 
                                      ColumnDefinitions="180,*,Auto"
                                      HorizontalAlignment="Stretch">
                                    <!-- ç”¨æˆ·è´¦å· -->
                                    <TextBlock Grid.Row="0" Grid.Column="0" 
                                               Classes="modern-label"
                                               Text="ç”¨æˆ·è´¦å·"
                                               VerticalAlignment="Center"
                                               Margin="0,0,24,0"/>
                                    <TextBox Grid.Row="0" Grid.Column="1" 
                                             Text="{Binding UserAccount}"
                                             IsEnabled="{Binding !IsRunning}"
                                             Watermark="è¯·è¾“å…¥ç”¨æˆ·è´¦å·"
                                             Margin="0,0,24,16"
                                             HorizontalAlignment="Stretch"/>

                                    <!-- ç”¨æˆ·å¯†ç  -->
                                    <TextBlock Grid.Row="1" Grid.Column="0" 
                                               Classes="modern-label"
                                               Text="ç”¨æˆ·å¯†ç "
                                               VerticalAlignment="Center"
                                               Margin="0,0,24,0"/>
                                    <TextBox Grid.Row="1" Grid.Column="1" 
                                             Text="{Binding UserPassword}"
                                             IsEnabled="{Binding !IsRunning}"
                                             PasswordChar="â—"
                                             Watermark="è¯·è¾“å…¥ç”¨æˆ·å¯†ç "
                                             Margin="0,0,24,16"
                                             HorizontalAlignment="Stretch"/>

                                    <!-- Cookie -->
                                    <TextBlock Grid.Row="2" Grid.Column="0" 
                                               Classes="modern-label"
                                               Text="Cookie"
                                               VerticalAlignment="Center"
                                               Margin="0,0,24,0"/>
                                    <TextBox Grid.Row="2" Grid.Column="1" 
                                             Text="{Binding Cookie}"
                                             IsEnabled="{Binding !IsRunning}"
                                             Watermark="è¯·è¾“å…¥Cookie(Httpå‘åŒ…æ¨¡å¼å¿…å¡«)"
                                             Margin="0,0,24,16"
                                             HorizontalAlignment="Stretch"/>
                                    <Border Grid.Row="2" Grid.Column="2" 
                                            Classes="warning-icon"
                                            Width="36" Height="36" 
                                            VerticalAlignment="Center"
                                            ToolTip.Tip="å¦‚æžœå¡«å†™äº†cookieä¸ç”¨å¡«è´¦å·å¯†ç ï¼ŒèŽ·å–æ–¹å¼ï¼šç™»é™†ä¸€æ¬¡åŽåœ¨æµè§ˆå™¨è®¾ç½®é‡ŒcookieæŸ¥æ‰¾ent.qpgzf.cnçš„cookie">
                                        <TextBlock Text="?"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontWeight="Bold"
                                                   FontSize="18"
                                                   Foreground="White"/>
                                    </Border>

                                    <!-- ç”³è¯·äººå§“å -->
                                    <TextBlock Grid.Row="3" Grid.Column="0" 
                                               Classes="modern-label"
                                               Text="ç”³è¯·äººå§“å"
                                               VerticalAlignment="Center"
                                               Margin="0,0,24,0"/>
                                    <TextBox Grid.Row="3" Grid.Column="1" 
                                             Text="{Binding ApplierName}"
                                             IsEnabled="{Binding !IsRunning}"
                                             Watermark="è¯·è¾“å…¥ç”³è¯·äººå§“å"
                                             HorizontalAlignment="Stretch"/>
                                </Grid>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- æ‰§è¡Œå‚æ•°é…ç½® -->
                    <Border Classes="collapsible-card" HorizontalAlignment="Stretch">
                        <Grid RowDefinitions="Auto,Auto">
                            <Button Grid.Row="0" 
                                    Classes="collapse-header"
                                    Click="OnExecutionToggle"
                                    x:Name="ExecutionToggleSingle">
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <TextBlock Text="â°" FontSize="20" VerticalAlignment="Center"/>
                                    <TextBlock Text="æ‰§è¡Œå‚æ•°é…ç½®" VerticalAlignment="Center"/>
                                    <TextBlock Text="â–¶" 
                                               x:Name="ExecutionIconSingle"
                                               FontSize="14" 
                                               VerticalAlignment="Center" 
                                               Foreground="{DynamicResource ThemeTextSecondary}"/>
                                </StackPanel>
                            </Button>

                            <StackPanel Grid.Row="1" 
                                        x:Name="ExecutionContentSingle"
                                        Spacing="16" 
                                        Margin="24,0,24,24"
                                        IsVisible="False">
                                <!-- å¼€å§‹æ—¶é—´ -->
                                <StackPanel Spacing="8">
                                    <TextBlock Classes="modern-label" Text="å¼€å§‹æ—¶é—´"/>
                                    <StackPanel Orientation="Horizontal" Spacing="12">
                                        <CalendarDatePicker SelectedDate="{Binding StartDate}" Width="200" IsEnabled="{Binding !IsRunning}"/>
                                        <TextBox Text="{Binding StartHour}" Width="80" Watermark="æ—¶" IsEnabled="{Binding !IsRunning}"/>
                                        <TextBlock Text=":" VerticalAlignment="Center" FontWeight="Bold" FontSize="16" Foreground="{DynamicResource ThemeTextPrimary}"/>
                                        <TextBox Text="{Binding StartMinute}" Width="80" Watermark="åˆ†" IsEnabled="{Binding !IsRunning}"/>
                                        <TextBlock Text=":" VerticalAlignment="Center" FontWeight="Bold" FontSize="16" Foreground="{DynamicResource ThemeTextPrimary}"/>
                                        <TextBox Text="{Binding StartSecond}" Width="80" Watermark="ç§’" IsEnabled="{Binding !IsRunning}"/>
                                    </StackPanel>
                                </StackPanel>

                                <!-- è§¦å‘é—´éš”å’Œè‡ªåŠ¨ç¡®è®¤ -->
                                <Grid ColumnDefinitions="*,*" HorizontalAlignment="Stretch">
                                    <StackPanel Grid.Column="0" Spacing="8">
                                        <TextBlock Classes="modern-label" Text="è§¦å‘é—´éš”(ms)"/>
                                        <TextBox Text="{Binding ClickInterval}" 
                                                 IsEnabled="{Binding !IsRunning}"
                                                 HorizontalAlignment="Stretch"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="1" Spacing="8" Margin="24,0,0,0">
                                        <TextBlock Classes="modern-label" Text="è‡ªåŠ¨ç¡®å®šæœ€åŽä¸€æ­¥"/>
                                        <StackPanel Orientation="Horizontal" Spacing="16">
                                            <CheckBox IsChecked="{Binding AutoConfirm}"
                                                      IsEnabled="{Binding !IsRunning}"
                                                      VerticalAlignment="Center"/>
                                            <Border Classes="danger-icon"
                                                    Width="32" Height="32" 
                                                    VerticalAlignment="Center"
                                                    ToolTip.Tip="æ…Žé‡é€‰æ‹©ï¼å¦‚æžœé€‰ä¸­ï¼Œç¨‹åºä¼šè‡ªåŠ¨ç‚¹å‡»æœ€åŽä¸€æ­¥æŠ¢æˆ¿ï¼Œå¦‚æžœä¸é€‰ä¸­ï¼Œç¨‹åºä¼šåœåœ¨æœ€åŽä¸€æ­¥ï¼Œéœ€è¦æ‰‹åŠ¨ç‚¹å‡»ç¡®è®¤">
                                                <TextBlock Text="!"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"
                                                           FontWeight="Bold"
                                                           FontSize="18"
                                                           Foreground="White"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- ç¤¾åŒºæ¡ä»¶è®¾ç½® -->
                    <Border Classes="collapsible-card" HorizontalAlignment="Stretch">
                        <Grid RowDefinitions="Auto,Auto">
                            <Button Grid.Row="0" 
                                    Classes="collapse-header"
                                    Click="OnCommunityToggle"
                                    x:Name="CommunityToggleSingle">
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <TextBlock Text="ðŸ˜ï¸" FontSize="20" VerticalAlignment="Center"/>
                                    <TextBlock Text="ç¤¾åŒºæ¡ä»¶è®¾ç½®" VerticalAlignment="Center"/>
                                    <Border Classes="success-icon"
                                            Width="28" Height="28" 
                                            VerticalAlignment="Center"
                                            Margin="12,0,0,0"
                                            ToolTip.Tip="å°åŒºä¸ºå¿…å¡«ï¼Œå±‚æ•°å¯ä»¥èŒƒå›´é€‰æ‹©ï¼Œä¾‹å¦‚2-4,6(æ³¨æ„è¦è‹±æ–‡é€—å·)ï¼Œå±‚æ•°ä¸å¡«å³ä¸ç­›é€‰ï¼Œå…¶ä»–å¦‚æžœå¡«0åˆ™é»˜è®¤ä¸ºä¸ç­›é€‰">
                                        <TextBlock Text="?"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontWeight="Bold"
                                                   FontSize="14"
                                                   Foreground="White"/>
                                    </Border>
                                    <TextBlock Text="â–¶" 
                                               x:Name="CommunityIconSingle"
                                               FontSize="14" 
                                               VerticalAlignment="Center" 
                                               Foreground="{DynamicResource ThemeTextSecondary}"/>
                                </StackPanel>
                            </Button>

                            <StackPanel Grid.Row="1" 
                                        x:Name="CommunityContentSingle"
                                        Spacing="20" 
                                        Margin="24,0,24,24"
                                        IsVisible="False">
                                <Button Classes="modern-primary" 
                                        Content="âž• æ·»åŠ æ¡ä»¶" 
                                        Command="{Binding AddCommunityCommand}" 
                                        IsEnabled="{Binding !IsRunning}"
                                        HorizontalAlignment="Left"/>

                                <!-- å•åˆ—å¸ƒå±€DataGrid -->
                                <DataGrid Classes="modern"
                                          ItemsSource="{Binding CommunityConditions}"
                                          CanUserReorderColumns="False"
                                          CanUserResizeColumns="False"
                                          CanUserSortColumns="False"
                                          GridLinesVisibility="None"
                                          HeadersVisibility="Column"
                                          MinHeight="200"
                                          Background="Transparent"
                                          BorderThickness="0"
                                          CornerRadius="12"
                                          AutoGenerateColumns="False"
                                          IsEnabled="{Binding !IsRunning}"
                                          Margin="0,8"
                                          HorizontalAlignment="Stretch">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="å°åŒºåç§°" Binding="{Binding CommunityName}" Width="2*" MinWidth="150" CanUserSort="False"/>
                                        <DataGridTextColumn Header="å¹¢å·" Binding="{Binding BuildingNo}" Width="1*" MinWidth="80" CanUserSort="False"/>
                                        <DataGridTextColumn Header="å±‚æ•°" Binding="{Binding FloorRange}" Width="1*" MinWidth="100" CanUserSort="False"/>
                                        <DataGridTextColumn Header="ä»·æ ¼" Binding="{Binding MaxPrice}" Width="1*" MinWidth="100" CanUserSort="False"/>
                                        <DataGridTextColumn Header="é¢ç§¯" Binding="{Binding LeastArea}" Width="1*" MinWidth="100" CanUserSort="False"/>
                                        <DataGridTemplateColumn Header="æˆ¿åž‹" Width="1*" MinWidth="100" CanUserSort="False">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <ComboBox SelectedItem="{Binding HouseTypeDescription}"
                                                              ItemsSource="{Binding $parent[Window].DataContext.HouseTypes}"
                                                              HorizontalAlignment="Stretch"
                                                              Margin="4,2"
                                                              FontSize="12"
                                                              BorderThickness="1"
                                                              Padding="6,4"
                                                              IsEnabled="{Binding $parent[Window].DataContext.IsRunning, Converter={StaticResource BoolToInverseConverter}}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="æ“ä½œ" Width="120" MinWidth="100" CanUserSort="False">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Classes="modern-danger" 
                                                            Content="åˆ é™¤" 
                                                            FontSize="12"
                                                            Padding="8,4"
                                                            Command="{Binding $parent[Window].DataContext.DeleteCommunityCommand}"
                                                            CommandParameter="{Binding}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </Grid>
                    </Border>
                </StackPanel>
                
                <!-- åŒåˆ—å¸ƒå±€ (çª—å£å®½åº¦ >= 1200px) -->
                <Grid x:Name="DoubleColumnLayout" 
                      IsVisible="False"
                      HorizontalAlignment="Stretch">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="600"/>
                        <ColumnDefinition Width="20"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- å·¦ä¾§é…ç½®é¢æ¿ -->
                    <StackPanel Grid.Column="0" Spacing="0">

                        <!-- è¿è¡Œæ¨¡å¼é…ç½® -->
                        <Border Classes="collapsible-card">
                            <Grid RowDefinitions="Auto,Auto">
                                <Button Grid.Row="0" 
                                        Classes="collapse-header"
                                        Click="OnOperationModeToggle"
                                        x:Name="OperationModeToggle">
                                    <StackPanel Orientation="Horizontal" Spacing="16">
                                        <TextBlock Text="ðŸš€" FontSize="20" VerticalAlignment="Center"/>
                                        <TextBlock Text="è¿è¡Œæ¨¡å¼é…ç½®" VerticalAlignment="Center"/>
                                        <TextBlock Text="â–¼" 
                                                   x:Name="OperationModeIcon"
                                                   FontSize="14" 
                                                   VerticalAlignment="Center" 
                                                   Foreground="{DynamicResource ThemeTextSecondary}"/>
                                    </StackPanel>
                                </Button>

                                <StackPanel Grid.Row="1" 
                                            x:Name="OperationModeContent"
                                            Spacing="20" 
                                            Margin="24,0,24,24">
                                    <StackPanel Orientation="Horizontal" Spacing="24">
                                        <StackPanel Spacing="8">
                                            <TextBlock Classes="modern-label" Text="è¿è¡Œæ¨¡å¼"/>
                                            <ComboBox Width="240" 
                                                      SelectedIndex="{Binding SelectedOperationMode}"
                                                      ItemsSource="{Binding OperationModes}"
                                                      IsEnabled="{Binding !IsRunning}"
                                                      ToolTip.Tip="æ¨¡æ‹Ÿç‚¹å‡»æ¨¡å¼å¯ä»¥çœ‹åˆ°å…·ä½“çš„æ“ä½œï¼Œåœ¨æœ€åŽä¸€æ­¥ç¡®è®¤éœ€è¦æ‰‹åŠ¨ç‚¹å‡»ï¼ŒæˆåŠŸçŽ‡è¾ƒé«˜ï¼Œä½†æ˜¯é€Ÿåº¦è¾ƒå‘åŒ…æ¨¡å¼æ…¢ï¼›å‘åŒ…æ¨¡å¼ç†è®ºé€Ÿåº¦æœ€å¿«ï¼Œä½†æ˜¯éœ€è¦cookieï¼Œå¹¶ä¸”ä¸ä¿è¯æˆåŠŸçŽ‡"/>
                                        </StackPanel>

                                        <StackPanel Spacing="8">
                                            <TextBlock Classes="modern-label" Text="æµè§ˆå™¨ç±»åž‹"/>
                                            <ComboBox Width="180" 
                                                      SelectedIndex="{Binding SelectedBrowserType}"
                                                      ItemsSource="{Binding BrowserTypes}"
                                                      IsEnabled="{Binding !IsRunning}"/>
                                        </StackPanel>

                                        <Border Classes="info-icon"
                                                Width="40" Height="40" 
                                                VerticalAlignment="Bottom"
                                                Margin="12,0,0,0"
                                                ToolTip.Tip="æ¨¡æ‹Ÿç‚¹å‡»æ¨¡å¼å¯ä»¥çœ‹åˆ°å…·ä½“çš„æ“ä½œï¼Œåœ¨æœ€åŽä¸€æ­¥ç¡®è®¤éœ€è¦æ‰‹åŠ¨ç‚¹å‡»ï¼ŒæˆåŠŸçŽ‡è¾ƒé«˜ï¼Œä½†æ˜¯é€Ÿåº¦è¾ƒå‘åŒ…æ¨¡å¼æ…¢ï¼›å‘åŒ…æ¨¡å¼ç†è®ºé€Ÿåº¦æœ€å¿«ï¼Œä½†æ˜¯éœ€è¦cookieï¼Œå¹¶ä¸”ä¸ä¿è¯æˆåŠŸçŽ‡">
                                            <TextBlock Text="?"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontWeight="Bold"
                                                       FontSize="20"
                                                       Foreground="White"/>
                                        </Border>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- è´¦æˆ·ä¿¡æ¯é…ç½® -->
                        <Border Classes="collapsible-card">
                            <Grid RowDefinitions="Auto,Auto">
                                <Button Grid.Row="0" 
                                        Classes="collapse-header"
                                        Click="OnAccountToggle"
                                        x:Name="AccountToggle">
                                    <StackPanel Orientation="Horizontal" Spacing="16">
                                        <TextBlock Text="ðŸ‘¤" FontSize="20" VerticalAlignment="Center"/>
                                        <TextBlock Text="è´¦æˆ·ä¿¡æ¯é…ç½®" VerticalAlignment="Center"/>
                                        <TextBlock Text="â–¶" 
                                                   x:Name="AccountIcon"
                                                   FontSize="14" 
                                                   VerticalAlignment="Center" 
                                                   Foreground="{DynamicResource ThemeTextSecondary}"/>
                                    </StackPanel>
                                </Button>

                                <StackPanel Grid.Row="1" 
                                            x:Name="AccountContent"
                                            Spacing="20" 
                                            Margin="24,0,24,24"
                                            IsVisible="False">
                                    <Grid RowDefinitions="Auto,Auto,Auto,Auto" ColumnDefinitions="160,*,Auto">
                                        <!-- ç”¨æˆ·è´¦å· -->
                                        <TextBlock Grid.Row="0" Grid.Column="0" 
                                                   Classes="modern-label"
                                                   Text="ç”¨æˆ·è´¦å·"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,24,0"/>
                                        <TextBox Grid.Row="0" Grid.Column="1" 
                                                 Text="{Binding UserAccount}"
                                                 IsEnabled="{Binding !IsRunning}"
                                                 Watermark="è¯·è¾“å…¥ç”¨æˆ·è´¦å·"
                                                 Margin="0,0,24,16"/>

                                        <!-- ç”¨æˆ·å¯†ç  -->
                                        <TextBlock Grid.Row="1" Grid.Column="0" 
                                                   Classes="modern-label"
                                                   Text="ç”¨æˆ·å¯†ç "
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,24,0"/>
                                        <TextBox Grid.Row="1" Grid.Column="1" 
                                                 Text="{Binding UserPassword}"
                                                 IsEnabled="{Binding !IsRunning}"
                                                 PasswordChar="â—"
                                                 Watermark="è¯·è¾“å…¥ç”¨æˆ·å¯†ç "
                                                 Margin="0,0,24,16"/>

                                        <!-- Cookie -->
                                        <TextBlock Grid.Row="2" Grid.Column="0" 
                                                   Classes="modern-label"
                                                   Text="Cookie"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,24,0"/>
                                        <TextBox Grid.Row="2" Grid.Column="1" 
                                                 Text="{Binding Cookie}"
                                                 IsEnabled="{Binding !IsRunning}"
                                                 Watermark="è¯·è¾“å…¥Cookie(Httpå‘åŒ…æ¨¡å¼å¿…å¡«)"
                                                 Margin="0,0,24,16"/>
                                        <Border Grid.Row="2" Grid.Column="2" 
                                                Classes="warning-icon"
                                                Width="36" Height="36" 
                                                VerticalAlignment="Center"
                                                ToolTip.Tip="å¦‚æžœå¡«å†™äº†cookieä¸ç”¨å¡«è´¦å·å¯†ç ï¼ŒèŽ·å–æ–¹å¼ï¼šç™»é™†ä¸€æ¬¡åŽåœ¨æµè§ˆå™¨è®¾ç½®é‡ŒcookieæŸ¥æ‰¾ent.qpgzf.cnçš„cookie">
                                            <TextBlock Text="?"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontWeight="Bold"
                                                       FontSize="18"
                                                       Foreground="White"/>
                                        </Border>

                                        <!-- ç”³è¯·äººå§“å -->
                                        <TextBlock Grid.Row="3" Grid.Column="0" 
                                                   Classes="modern-label"
                                                   Text="ç”³è¯·äººå§“å"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,24,0"/>
                                        <TextBox Grid.Row="3" Grid.Column="1" 
                                                 Text="{Binding ApplierName}"
                                                 IsEnabled="{Binding !IsRunning}"
                                                 Watermark="è¯·è¾“å…¥ç”³è¯·äººå§“å"/>
                                    </Grid>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- æ‰§è¡Œå‚æ•°é…ç½® -->
                        <Border Classes="collapsible-card">
                            <Grid RowDefinitions="Auto,Auto">
                                <Button Grid.Row="0" 
                                        Classes="collapse-header"
                                        Click="OnExecutionToggle"
                                        x:Name="ExecutionToggle">
                                    <StackPanel Orientation="Horizontal" Spacing="16">
                                        <TextBlock Text="â°" FontSize="20" VerticalAlignment="Center"/>
                                        <TextBlock Text="æ‰§è¡Œå‚æ•°é…ç½®" VerticalAlignment="Center"/>
                                        <TextBlock Text="â–¶" 
                                                   x:Name="ExecutionIcon"
                                                   FontSize="14" 
                                                   VerticalAlignment="Center" 
                                                   Foreground="{DynamicResource ThemeTextSecondary}"/>
                                    </StackPanel>
                                </Button>

                                <StackPanel Grid.Row="1" 
                                            x:Name="ExecutionContent"
                                            Spacing="16" 
                                            Margin="24,0,24,24"
                                            IsVisible="False">
                                    <!-- å¼€å§‹æ—¶é—´ -->
                                    <StackPanel Spacing="8">
                                        <TextBlock Classes="modern-label" Text="å¼€å§‹æ—¶é—´"/>
                                        <StackPanel Orientation="Horizontal" Spacing="12">
                                            <CalendarDatePicker SelectedDate="{Binding StartDate}" Width="160" IsEnabled="{Binding !IsRunning}"/>
                                            <TextBox Text="{Binding StartHour}" Width="60" Watermark="æ—¶" IsEnabled="{Binding !IsRunning}"/>
                                            <TextBlock Text=":" VerticalAlignment="Center" FontWeight="Bold" FontSize="16" Foreground="{DynamicResource ThemeTextPrimary}"/>
                                            <TextBox Text="{Binding StartMinute}" Width="60" Watermark="åˆ†" IsEnabled="{Binding !IsRunning}"/>
                                            <TextBlock Text=":" VerticalAlignment="Center" FontWeight="Bold" FontSize="16" Foreground="{DynamicResource ThemeTextPrimary}"/>
                                            <TextBox Text="{Binding StartSecond}" Width="60" Watermark="ç§’" IsEnabled="{Binding !IsRunning}"/>
                                        </StackPanel>
                                    </StackPanel>

                                    <!-- è§¦å‘é—´éš” -->
                                    <StackPanel Spacing="8">
                                        <TextBlock Classes="modern-label" Text="è§¦å‘é—´éš”(ms)"/>
                                        <TextBox Text="{Binding ClickInterval}" 
                                                 Width="140"
                                                 HorizontalAlignment="Left"
                                                 IsEnabled="{Binding !IsRunning}"/>
                                    </StackPanel>

                                    <!-- è‡ªåŠ¨ç¡®è®¤ -->
                                    <StackPanel Spacing="8">
                                        <TextBlock Classes="modern-label" Text="è‡ªåŠ¨ç¡®å®šæœ€åŽä¸€æ­¥"/>
                                        <StackPanel Orientation="Horizontal" Spacing="16">
                                            <CheckBox IsChecked="{Binding AutoConfirm}"
                                                      IsEnabled="{Binding !IsRunning}"
                                                      VerticalAlignment="Center"/>
                                            <Border Classes="danger-icon"
                                                    Width="32" Height="32" 
                                                    VerticalAlignment="Center"
                                                    ToolTip.Tip="æ…Žé‡é€‰æ‹©ï¼å¦‚æžœé€‰ä¸­ï¼Œç¨‹åºä¼šè‡ªåŠ¨ç‚¹å‡»æœ€åŽä¸€æ­¥æŠ¢æˆ¿ï¼Œå¦‚æžœä¸é€‰ä¸­ï¼Œç¨‹åºä¼šåœåœ¨æœ€åŽä¸€æ­¥ï¼Œéœ€è¦æ‰‹åŠ¨ç‚¹å‡»ç¡®è®¤">
                                                <TextBlock Text="!"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"
                                                           FontWeight="Bold"
                                                           FontSize="18"
                                                           Foreground="White"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </StackPanel>
                    
                    <!-- å³ä¾§ç¤¾åŒºæ¡ä»¶è®¾ç½®é¢æ¿ -->
                    <Border Grid.Column="2" Classes="collapsible-card">
                        <Grid RowDefinitions="Auto,Auto">
                            <Button Grid.Row="0" 
                                    Classes="collapse-header"
                                    Click="OnCommunityToggle"
                                    x:Name="CommunityToggle">
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <TextBlock Text="ðŸ˜ï¸" FontSize="20" VerticalAlignment="Center"/>
                                    <TextBlock Text="ç¤¾åŒºæ¡ä»¶è®¾ç½®" VerticalAlignment="Center"/>
                                    <Border Classes="success-icon"
                                            Width="28" Height="28" 
                                            VerticalAlignment="Center"
                                            Margin="12,0,0,0"
                                            ToolTip.Tip="å°åŒºä¸ºå¿…å¡«ï¼Œå±‚æ•°å¯ä»¥èŒƒå›´é€‰æ‹©ï¼Œä¾‹å¦‚2-4,6(æ³¨æ„è¦è‹±æ–‡é€—å·)ï¼Œå±‚æ•°ä¸å¡«å³ä¸ç­›é€‰ï¼Œå…¶ä»–å¦‚æžœå¡«0åˆ™é»˜è®¤ä¸ºä¸ç­›é€‰">
                                        <TextBlock Text="?"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontWeight="Bold"
                                                   FontSize="14"
                                                   Foreground="White"/>
                                    </Border>
                                    <TextBlock Text="â–¶" 
                                               x:Name="CommunityIcon"
                                               FontSize="14" 
                                               VerticalAlignment="Center" 
                                               Foreground="{DynamicResource ThemeTextSecondary}"/>
                                </StackPanel>
                            </Button>

                            <StackPanel Grid.Row="1" 
                                        x:Name="CommunityContent"
                                        Spacing="20" 
                                        Margin="24,0,24,24"
                                        IsVisible="False">
                                <Button Classes="modern-primary" 
                                        Content="âž• æ·»åŠ æ¡ä»¶" 
                                        Command="{Binding AddCommunityCommand}" 
                                        IsEnabled="{Binding !IsRunning}"
                                        HorizontalAlignment="Left"/>

                                <!-- åŒåˆ—å¸ƒå±€çš„å®Œå…¨å“åº”å¼DataGrid -->
                                <DataGrid Classes="modern"
                                          ItemsSource="{Binding CommunityConditions}"
                                          CanUserReorderColumns="False"
                                          CanUserResizeColumns="False"
                                          CanUserSortColumns="False"
                                          GridLinesVisibility="None"
                                          HeadersVisibility="Column"
                                          MinHeight="200"
                                          Background="Transparent"
                                          BorderThickness="0"
                                          CornerRadius="12"
                                          AutoGenerateColumns="False"
                                          IsEnabled="{Binding !IsRunning}"
                                          Margin="0,8"
                                          HorizontalAlignment="Stretch">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="å°åŒºåç§°" Binding="{Binding CommunityName}" Width="*" MinWidth="120" CanUserSort="False"/>
                                        <DataGridTextColumn Header="å¹¢å·" Binding="{Binding BuildingNo}" Width="80" MinWidth="60" CanUserSort="False"/>
                                        <DataGridTextColumn Header="å±‚æ•°" Binding="{Binding FloorRange}" Width="100" MinWidth="80" CanUserSort="False"/>
                                        <DataGridTextColumn Header="ä»·æ ¼" Binding="{Binding MaxPrice}" Width="120" MinWidth="100" CanUserSort="False"/>
                                        <DataGridTextColumn Header="é¢ç§¯" Binding="{Binding LeastArea}" Width="120" MinWidth="100" CanUserSort="False"/>
                                        <DataGridTemplateColumn Header="æˆ¿åž‹" Width="100" MinWidth="80" CanUserSort="False">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <ComboBox SelectedItem="{Binding HouseTypeDescription}"
                                                              ItemsSource="{Binding $parent[Window].DataContext.HouseTypes}"
                                                              HorizontalAlignment="Stretch"
                                                              Margin="4,2"
                                                              FontSize="12"
                                                              BorderThickness="1"
                                                              Padding="6,4"
                                                              IsEnabled="{Binding $parent[Window].DataContext.IsRunning, Converter={StaticResource BoolToInverseConverter}}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="æ“ä½œ" Width="90" MinWidth="80" CanUserSort="False">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Classes="modern-danger" 
                                                            Content="åˆ é™¤" 
                                                            FontSize="12"
                                                            Padding="8,4"
                                                            Command="{Binding $parent[Window].DataContext.DeleteCommunityCommand}"
                                                            CommandParameter="{Binding}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </Panel>
        </ScrollViewer>

        <!-- å›ºå®šçš„æ—¥å¿—è¾“å‡ºåŒºåŸŸ - å¯æ‰‹åŠ¨æ‹–æ‹½è°ƒæ•´é«˜åº¦ -->
        <Border Grid.Row="2" 
                Classes="modern-card"
                Margin="16,16,16,0"
                x:Name="LogArea"
                Height="260"
                MinHeight="120"
                MaxHeight="600">
            <Grid RowDefinitions="Auto,Auto,*">
                <!-- æ‹–æ‹½æ‰‹æŸ„åŒºåŸŸ -->
                <Border Grid.Row="0" 
                        Height="8" 
                        Background="Transparent"
                        Cursor="SizeNorthSouth"
                        x:Name="ResizeHandle">
                    <Border Height="3" 
                            Background="{DynamicResource ThemeBorder}" 
                            CornerRadius="2" 
                            Margin="40,0"
                            Opacity="0.6"/>
                </Border>
                
                <!-- æ ‡é¢˜åŒºåŸŸ -->
                <StackPanel Grid.Row="1" 
                            Orientation="Horizontal" 
                            Spacing="16" 
                            Margin="0,8,0,16">
                    <TextBlock Text="ðŸ“‹" FontSize="20" VerticalAlignment="Center"/>
                    <TextBlock Classes="modern-title" Text="æ—¥å¿—è¾“å‡º" FontSize="22"/>
                </StackPanel>
                
                <!-- æ—¥å¿—å†…å®¹åŒºåŸŸ -->
                <ScrollViewer Grid.Row="2" 
                              VerticalScrollBarVisibility="Auto" 
                              HorizontalScrollBarVisibility="Disabled"
                              x:Name="LogScrollViewer">
                    <TextBox Classes="modern-log"
                             Text="{Binding LogText}"
                             IsReadOnly="True"
                             AcceptsReturn="True"
                             TextWrapping="Wrap"
                             x:Name="LogTextBox"/>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- å›ºå®šçš„æ“ä½œæŒ‰é’®åŒºåŸŸ - å“åº”å¼è®¾è®¡ -->
        <Border Grid.Row="3" 
                BorderBrush="{DynamicResource ThemeBorder}" 
                BorderThickness="0,1,0,0"
                Padding="16,20"
                x:Name="FooterBorder">
            <Border.Background>
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                    <GradientStop Color="#FFFFFF" Offset="0"/>
                    <GradientStop Color="#F8F9FA" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Grid MaxWidth="1000" HorizontalAlignment="Center">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" MaxWidth="160"/>
                    <ColumnDefinition Width="*" MaxWidth="160"/>
                    <ColumnDefinition Width="Auto" MaxWidth="200"/>
                    <ColumnDefinition Width="160"/>
                </Grid.ColumnDefinitions>
                
                <Button Grid.Column="0"
                        Classes="modern-primary" 
                        Content="ðŸš€ å¼€å§‹æŠ¢æˆ¿" 
                        Command="{Binding StartProcessCommand}"
                        IsEnabled="{Binding !IsRunning}"
                        Margin="0,0,8,0"
                        FontSize="15"/>
                
                <Button Grid.Column="1"
                        Classes="modern-secondary" 
                        Content="â¹ï¸ åœæ­¢æŠ¢æˆ¿" 
                        Command="{Binding StopProcessCommand}"
                        IsEnabled="{Binding IsRunning}"
                        Margin="4,0,4,0"
                        FontSize="15"/>
                
                <Button Grid.Column="2"
                        Classes="modern-secondary" 
                        Content="ðŸ” èŽ·å–æˆ¿é—´ID" 
                        Command="{Binding FetchRoomIdsCommand}"
                        Margin="8,0,16,0"
                        FontSize="15"
                        ToolTip.Tip="æå‰èŽ·å–æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æˆ¿é—´IDï¼ŒåŠ é€ŸæŠ¢æˆ¿">
                    <Button.IsVisible>
                        <Binding Path="SelectedOperationMode" Converter="{StaticResource IntToBoolConverter}" ConverterParameter="1"/>
                    </Button.IsVisible>
                    <Button.IsEnabled>
                        <MultiBinding Converter="{StaticResource MultiBoolConverter}">
                            <Binding Path="!IsRunning"/>
                            <Binding Path="!IsFetchingRoomIds"/>
                        </MultiBinding>
                    </Button.IsEnabled>
                </Button>
                
                <Button Grid.Column="3"
                        Classes="github-icon" 
                        Content="G" 
                        Command="{Binding OpenGitHubCommand}"
                        ToolTip.Tip="è®¿é—®GitHub"/>
            </Grid>
        </Border>

    </Grid>

</Window>
